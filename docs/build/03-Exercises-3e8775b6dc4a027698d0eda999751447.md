# Exercices

**Authors:** Clément Hardy<sup>1</sup> \
**Affiliations:** <sup>1</sup>Université du Québec en Outaouais (UQO)\

[![Made with MyST](https://img.shields.io/badge/made%20with-myst-orange)](https://myst.tools)

## Thinking about what you can do with Magic Harvest

The three exercices that I propose here will not ask you to code in any programming langage.

What I'm going to do is ask you to write step-by-step algorithms in plain english about what a possible script used with Magic Harvest (whatever the programming langage you choose down the road) will be used for different use case.

In that way, when you'll try to use Magic Harvest for your own research, I hope that you'll have a general idea of what you'll want to do with it. The implementation of your algorithm in a programming - the coding part - is not necesseraly the most complex thing to do, especially with the new AI tools that are accessible today.

## Example of an algorithm in plain english

![](./images/Slide28.jpg)</br>

Here is an example of the kind of algorithm I propose that you'll write in the following exercises, in plain english. 

Here, we'll simply write the algorithm for a script that will do the following :

We want to do repeated partial cutting every 30 years for 90 years, and simple clearcutting in a landscape : So here, what we want to do is to harvest a certain percentage of the target with partial cutting, which demands that when we select a stand for harvesting with partial cutting, we have to come back every 30 years to harvest it until we reach 90 years, and then we stop coming back. 

Here is the resulting algorithm in plain english to write a script that will do this with Magic Harvest :

- Read the state of the landscape and put it in variables
- Define or read target of hectares to harvest with partial cutting and clear cutting
- Read a file containing information about stands that have been registered with repeated partial cutting and put it in a variable
- For each stand registered for repeated partial cutting :
	- Check if this year should be a year where the given stand is harvested with partial cutting (period of 30 years)
		- If it is the case, write the code corresponding to partial cutting in the management map for all of the pixels of the stand, and then record the - next time that the stand should be harvested in the variable
	- If not, do nothing.
	- Check if the stand has reached its last partial cutting (90 years are done)
		- If so, remove the stand from the variable
- Check if we need to add new stands to list of regular partial cutting reach the % of hectare harvested each year with partial cutting
	- If that's the case, rank the stands in the landscape based on their biomass.
	- Then, select stands starting with those with a lot of biomass until we reach the target. Add each of these stands to the list of repeated partial-  cutting.
- Then, look at all of the stands in the landscape and rank them by biomass
	- For each stand, looking at those with the most biomass first, register them for harvesting with clearcutting in the management map for all of the-  pixels of the stand
	- Stop when we have reached the target of hectares to harvest with clearcutting
- Export the management map and edit the parameter files of B. Harvest.


## First exercise - Salvage logging

```{exercise}
:label: exercise-1

![](./images/Slide30.jpg)</br>

Let's start simple : we're going to do salvage logging. 

We want that when a fire happens in the landscape, B. Harvest will go and harvest 70% all stands impacted by the fire (remember that a stand is a group of pixels in LANDIS-II). The prescription we will used called "salvage logging" will be pre-defined in the B. Harvest parameter text file, so we do not need to create it in the script. The rest of the harvesting for the current timestep will be left to B. Harvest to decide; so here, we do not take complete control.

Basically, that means that we are going to take the fire map created by one of the fire extensions of LANDIS-II; the management area map of B. Harvest; and we're going to merge the two to create a new management area corresponding to the fire. Then, we'll have to make sure that B. Harvest will harvest 70% of the surfaced of this new management area with the salvage logging prescription.

```

````{solution} exercise-1
:label: my-solution-exercise-1
:class: dropdown

Here is the resulting algorithm in plain english to write a script that will do this with Magic Harvest.

The solution here is relatively simple, because we're letting Biomass Harvest take a lot of decisions.

![](./images/Slide31.jpg)</br>

- Read latest fire map

- Edit the management area map to create a new one on the disturbance

- Edit the biomass harvest parameter file to make sure it will read the new map and edit its implementation table to add a new line to harvest 70% of the stands or of the surface of the new management area

````

## Second exercise - Clearcutting, Partial cutting and protected areas

```{exercise}
:label: exercise-2

![](./images/Slide32.jpg)</br>

We want to harvest with clearcutting and partial cutting until we reach a target of biomass. Not a target of surface, but a target of biomass. So here, we're taking complete control of what pixels and stands we will harvest, and we will make all of the decision to choose them. But we will stop when we have reached enough biomass harvest - something that B. Harvest cannot do, because B. Harvest cannot use biomass targets, only surface ! We will harvest 70% of the target of biomass with clearcutting, and then 30% with partial cutting. We will prioritize stands with the most biomass in them, but we will avoid stands located in protected areas.

So, we're going to read the stands in the landscapes; define a biomass target (it doesn't matter the number, just know that we have one); we're going to rank the stands, and then select stands with clearcutting or partial cutting until 70% of the biomass target is harvested with clearcutting, and 30% with partial cutting. And of course, we'll be mindful of the protected areas.

This one is going to be much more complex since we're taking complete control of what pixels will be harvested exactly. Take your time; you will surely encounter problems as you go forwards, for which you will have to go back and edit the beginning of your algorithm to get things ready for the rest.
```

````{solution} exercise-2
:label: my-solution-exercise-2
:class: dropdown

Here is the resulting algorithm in plain english to write a script that will do this with Magic Harvest.

The solution here is relatively simple, because we're letting Biomass Harvest take a lot of decisions.

![](./images/Slide31.jpg)</br>

- Read latest fire map

- Edit the management area map to create a new one on the disturbance

- Edit the biomass harvest parameter file to make sure it will read the new map and edit its implementation table to add a new line to harvest 70% of the stands or of the surface of the new management area

````


